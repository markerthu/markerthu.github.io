{% include base_path %}


<!-- start custom head snippets -->

<link rel="apple-touch-icon" sizes="57x57" href="{{ base_path }}/images/apple-touch-icon-57x57.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="60x60" href="{{ base_path }}/images/apple-touch-icon-60x60.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="72x72" href="{{ base_path }}/images/apple-touch-icon-72x72.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="76x76" href="{{ base_path }}/images/apple-touch-icon-76x76.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="114x114" href="{{ base_path }}/images/apple-touch-icon-114x114.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="120x120" href="{{ base_path }}/images/apple-touch-icon-120x120.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="144x144" href="{{ base_path }}/images/apple-touch-icon-144x144.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="152x152" href="{{ base_path }}/images/apple-touch-icon-152x152.png?v=M44lzPylqQ">
<link rel="apple-touch-icon" sizes="180x180" href="{{ base_path }}/images/apple-touch-icon-180x180.png?v=M44lzPylqQ">
<link rel="icon" type="image/svg+xml" href="{{ base_path }}/images/favicon.svg"/>
<link rel="icon" type="image/png" href="{{ base_path }}/images/favicon-32x32.png" sizes="32x32"/>
<link rel="icon" type="image/png" href="{{ base_path }}/images/favicon-192x192.png" sizes="192x192"/>
<link rel="icon" href="/images/favicon.ico"/>
<link rel="manifest" href="{{ base_path }}/images/manifest.json?v=M44lzPylqQ">
<link rel="mask-icon" href="{{ base_path }}/images/safari-pinned-tab.svg?v=M44lzPylqQ" color="#000000">
<link rel="shortcut icon" href="/images/favicon.ico">
<meta name="msapplication-TileColor" content="#000000">
<meta name="msapplication-TileImage" content="{{ base_path }}/images/mstile-144x144.png?v=M44lzPylqQ">
<meta name="msapplication-config" content="{{ base_path }}/images/browserconfig.xml?v=M44lzPylqQ">
<meta name="theme-color" content="#ffffff">
<link rel="stylesheet" href="{{ base_path }}/assets/css/academicons.css"/>

<script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script>

<!-- Custom global styles for modern academic look -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
  /* ── Typography upgrade ── */
  body, .page__content, .sidebar, .author__bio, .author__urls {
    font-family: 'Inter', 'Segoe UI', Arial, sans-serif;
  }

  /* ── Author sidebar polished ── */
  .author__avatar img {
    border-radius: 50%;
    border: 3px solid #1565c0;
    box-shadow: 0 4px 20px rgba(21,101,192,0.22);
    transition: transform 0.3s, box-shadow 0.3s;
  }
  .author__avatar img:hover {
    transform: scale(1.05);
    box-shadow: 0 8px 28px rgba(21,101,192,0.3);
  }
  .author__name {
    font-size: 1.18em;
    font-weight: 800;
    letter-spacing: -0.02em;
    color: #1a2332;
  }
  .author__bio {
    font-size: 0.88em;
    color: #444;
    line-height: 1.6;
    margin-top: 6px;
  }
  .author__urls-wrapper .btn {
    font-size: 0.82em;
    padding: 4px 8px;
  }
  .author__urls a {
    font-size: 0.84em;
    color: #1565c0 !important;
    transition: color 0.2s;
  }
  .author__urls a:hover { color: #0d47a1 !important; }

  /* ── Masthead / nav — gradient underline ── */
  .masthead {
    background: #fff;
    box-shadow: 0 2px 12px rgba(0,0,0,0.06);
    position: relative;
  }
  .masthead::after {
    content: '';
    position: absolute;
    bottom: 0; left: 0; right: 0;
    height: 3px;
    background: linear-gradient(to right, #1565c0 0%, #7c4dff 50%, #00897b 100%);
  }
  .masthead__inner-wrap { max-width: 1280px; }
  .site-title {
    font-weight: 800 !important;
    letter-spacing: -0.02em;
    color: #1a2332 !important;
  }
  .greedy-nav a {
    font-weight: 600;
    font-size: 0.9em;
    letter-spacing: 0.01em;
    color: #333 !important;
    transition: color 0.2s;
  }
  .greedy-nav a:hover { color: #1565c0 !important; }
  .greedy-nav .visible-links a::before {
    background: #1565c0;
  }

  /* ── Page layout ── */
  .page__content {
    font-size: 0.95em;
    line-height: 1.7;
  }
  .page__content h2 {
    font-weight: 800;
    font-size: 1.3em;
    color: #1a2332;
    margin-top: 1.8em;
    letter-spacing: -0.01em;
  }
  .page__content h3 { font-weight: 700; color: #1a2332; }
  .page__content a { color: #1565c0; }
  .page__content a:hover { text-decoration: underline; }
  .page__content p { margin-bottom: 1em; }

  /* ── Publications archive page ── */
  .archive__item-title {
    font-size: 0.98em;
    font-weight: 700;
    line-height: 1.4;
  }
  .archive__item-title a { color: #1565c0; }
  .archive__item-excerpt {
    font-size: 0.85em;
    color: #555;
    line-height: 1.5;
    margin-top: 4px;
  }
  .list__item {
    border-bottom: 1px solid #eef0f3;
    padding: 12px 0;
  }

  /* ── Blockquote ── */
  .page__content blockquote {
    background: #f0f4ff;
    border-left: 4px solid #1565c0;
    border-radius: 0 8px 8px 0;
    padding: 14px 20px;
    color: #333;
    font-size: 0.95em;
    font-style: normal;
  }

  /* ── Footer ── */
  .page__footer {
    background: #0d1b2a;
    color: #8899aa;
    border-top: 3px solid #1565c0;
  }
  .page__footer a { color: #7eb8f7; }
  .page__footer-follow .social-icons .fa { color: #7eb8f7; }

  /* ── Sidebar wider on xl ── */
  @media (min-width: 80em) {
    .sidebar.sticky { padding-top: 2em; }
  }

  /* ── Smooth scrolling ── */
  html { scroll-behavior: smooth; }

  /* ── Reading progress bar (blog posts only) ── */
  #reading-progress {
    position: fixed;
    top: 0; left: 0;
    height: 3px;
    width: 0%;
    z-index: 9999;
    background: linear-gradient(to right, #1565c0, #7c4dff, #00897b);
    transition: width 0.08s linear;
    pointer-events: none;
  }

  /* ── Anti-flash: apply dark background before body loads ── */
  html.dark-mode-pending { background: #0d1117; }
  /* ── Global Dark Mode (applied from homepage toggle, persisted in localStorage) ── */
  body.dark-mode { background: #0d1117 !important; color: #c9d1d9 !important; }
  body.dark-mode .page__content { color: #c9d1d9 !important; }
  body.dark-mode .masthead { background: #161b22 !important; box-shadow: 0 1px 8px rgba(0,0,0,0.4) !important; }
  body.dark-mode .masthead::after { background: linear-gradient(to right, #1565c0 0%, #7c4dff 50%, #00897b 100%) !important; }
  body.dark-mode .site-title { color: #e6edf3 !important; }
  body.dark-mode .greedy-nav, body.dark-mode .greedy-nav a { background: #161b22 !important; color: #8b949e !important; }
  body.dark-mode .greedy-nav a:hover { color: #58a6ff !important; }
  body.dark-mode .sidebar { background: #0d1117 !important; }
  body.dark-mode .author__name { color: #e6edf3 !important; }
  body.dark-mode .author__bio { color: #8b949e !important; }
  body.dark-mode .author__urls a { color: #58a6ff !important; }
  body.dark-mode .page__title { color: #e6edf3 !important; }
  body.dark-mode .page__content h2, body.dark-mode .page__content h3 { color: #e6edf3 !important; }
  body.dark-mode .page__content a { color: #58a6ff !important; }
  body.dark-mode .page__content p { color: #8b949e !important; }
  body.dark-mode .page__footer { background: #010409 !important; border-top-color: #21262d !important; }
  body.dark-mode .page__footer a { color: #58a6ff !important; }
  body.dark-mode .page__inner-wrap, body.dark-mode #main, body.dark-mode .page { background: #0d1117 !important; }
  body.dark-mode .list__item { border-bottom-color: #21262d !important; }
  body.dark-mode .archive__item-title a { color: #58a6ff !important; }
  body.dark-mode .archive__item-excerpt { color: #8b949e !important; }
</style>
<script>
  /* Apply dark mode on page load (before paint) to prevent flash */
  if(localStorage.getItem('darkMode')==='true') document.documentElement.classList.add('dark-mode-pending');
  document.addEventListener('DOMContentLoaded', function(){
    if(localStorage.getItem('darkMode')==='true') document.body.classList.add('dark-mode');
  });
</script>

{% if page.date %}
<!-- Blog post specific styles — academic grade, eye-protective -->
<style>
  /*
   * Color rationale (护眼 / ICLR-grade):
   *   Page bg   #eef1f1  — 10% tint of #90A5A7, removes harsh glare
   *   Content   #ffffff  — pure white card, crisp contrast for reading
   *   Text      #2d3748  — dark slate (not pure black), reduces eye strain
   *   Accent    #90A5A7  — muted steel-teal for decorative elements
   *   Links     #2c6e8a  — desaturated academic blue-teal, not jarring
   */

  /* ── Page background: soft warm teal tint ── */
  html, body {
    background: #eef1f1 !important;
  }

  /* ── Content card: white on tinted bg, gentle shadow ── */
  .page__inner-wrap {
    background: #ffffff;
    border-radius: 10px;
    box-shadow: 0 1px 3px rgba(144,165,167,0.15), 0 6px 32px rgba(144,165,167,0.18);
    overflow: hidden;
  }

  /* ── Sidebar: white card, matching radius ── */
  .sidebar.sticky {
    background: #ffffff !important;
    border-radius: 10px;
    box-shadow: 0 1px 3px rgba(144,165,167,0.12), 0 4px 18px rgba(144,165,167,0.14);
    padding: 18px 14px;
    margin-top: 8px;
  }

  /* ── Body text: dark slate (softer than #000) ── */
  .page--post .page__content,
  .page--post .page__content p,
  .page--post .page__content li {
    color: #2d3748;
    line-height: 1.78;
    font-size: 0.96em;
  }

  /* ── Headings ── */
  .page--post .page__content h2 {
    border-left: 4px solid #90A5A7;
    padding-left: 14px;
    color: #1a2332;
    font-weight: 800;
    margin-top: 2em;
  }
  .page--post .page__content h3 {
    color: #2d3748;
    font-weight: 700;
    margin-top: 1.6em;
  }

  /* ── Links: muted academic teal-blue ── */
  .page--post .page__content a {
    color: #2c6e8a;
    text-decoration: none;
    border-bottom: 1px solid rgba(44,110,138,0.25);
    transition: color 0.15s, border-color 0.15s;
  }
  .page--post .page__content a:hover {
    color: #1a4f66;
    border-bottom-color: rgba(26,79,102,0.6);
  }

  /* ── Blockquote: teal-tinted, scholarly ── */
  .page--post .page__content blockquote {
    background: #f2f6f6;
    border-left: 4px solid #90A5A7;
    border-radius: 0 8px 8px 0;
    padding: 14px 20px;
    color: #3d5461;
    font-style: normal;
    font-size: 0.95em;
  }

  /* ── Code: neutral background ── */
  .page--post .page__content pre,
  .page--post .page__content code {
    background: #f4f7f7;
    border: 1px solid #dce5e6;
    border-radius: 5px;
    font-size: 0.875em;
    color: #2d3748;
  }
  .page--post .page__content pre code {
    border: none;
    background: transparent;
  }

  /* ── Horizontal rules: subtle teal tint ── */
  .page--post .page__content hr {
    border: none;
    border-top: 2px solid #dce5e6;
    margin: 2em 0;
  }

  /* ── Images: constrain tall ones (e.g. square radar charts) ── */
  .page--post .page__content figure img,
  .page--post .page__content p img {
    max-height: 440px;
    object-fit: contain;
    width: 100%;
    height: auto;
    display: block;
    margin: 0 auto;
    border-radius: 6px;
  }

  /* ── Reading progress bar: #90A5A7 teal gradient ── */
  #reading-progress {
    background: linear-gradient(to right, #90A5A7, #607d8b, #90A5A7) !important;
  }

  /* ─────────────── Dark mode ─────────────── */
  body.dark-mode {
    background: #0d1117 !important;
  }
  body.dark-mode .page__inner-wrap {
    background: #161b22 !important;
    box-shadow: 0 1px 3px rgba(0,0,0,0.3), 0 6px 32px rgba(0,0,0,0.35) !important;
  }
  body.dark-mode .sidebar.sticky {
    background: #161b22 !important;
    box-shadow: 0 1px 3px rgba(0,0,0,0.25), 0 4px 18px rgba(0,0,0,0.3) !important;
  }
  body.dark-mode .page--post .page__content,
  body.dark-mode .page--post .page__content p,
  body.dark-mode .page--post .page__content li { color: #b5c2c8 !important; }
  body.dark-mode .page--post .page__content h2 {
    color: #e2eaec !important;
    border-left-color: #90A5A7 !important;
  }
  body.dark-mode .page--post .page__content h3 { color: #c8d6da !important; }
  body.dark-mode .page--post .page__content a { color: #7cb9ca !important; border-bottom-color: rgba(124,185,202,0.3) !important; }
  body.dark-mode .page--post .page__content a:hover { color: #a8d4e0 !important; }
  body.dark-mode .page--post .page__content blockquote {
    background: #1c2b30 !important;
    color: #8faab1 !important;
    border-left-color: #90A5A7 !important;
  }
  body.dark-mode .page--post .page__content pre,
  body.dark-mode .page--post .page__content code {
    background: #1c2428 !important;
    border-color: #2d3f45 !important;
    color: #b5c2c8 !important;
  }
  body.dark-mode .page--post .page__content hr { border-top-color: #2a3f47 !important; }
</style>

<!-- Reading progress bar + code copy buttons (blog posts only) -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    /* Reading progress bar */
    var bar = document.createElement('div');
    bar.id = 'reading-progress';
    document.body.insertBefore(bar, document.body.firstChild);
    window.addEventListener('scroll', function() {
      var total = document.documentElement.scrollHeight - window.innerHeight;
      bar.style.width = (total > 0 ? (window.scrollY / total * 100) : 0) + '%';
    }, { passive: true });

    /* Code block copy buttons */
    document.querySelectorAll('pre').forEach(function(pre) {
      var wrap = document.createElement('div');
      wrap.style.cssText = 'position:relative;';
      pre.parentNode.insertBefore(wrap, pre);
      wrap.appendChild(pre);

      var btn = document.createElement('button');
      btn.textContent = 'Copy';
      btn.style.cssText = [
        'position:absolute', 'top:8px', 'right:10px',
        'background:rgba(255,255,255,0.9)', 'border:1px solid #e2e8f0',
        'border-radius:5px', 'padding:2px 10px', 'font-size:0.75em',
        'cursor:pointer', 'color:#555', 'font-family:Inter,sans-serif',
        'transition:all 0.15s', 'z-index:10'
      ].join(';');
      btn.addEventListener('click', function() {
        var code = pre.querySelector('code') || pre;
        navigator.clipboard.writeText(code.innerText).then(function() {
          btn.textContent = '✓ Copied';
          btn.style.color = '#00897b';
          setTimeout(function() { btn.textContent = 'Copy'; btn.style.color = '#555'; }, 1800);
        });
      });
      wrap.appendChild(btn);
    });
  });
</script>
{% endif %}

<!-- end custom head snippets -->
